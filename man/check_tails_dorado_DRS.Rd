% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/check_tails_dorado_DRS.R
\name{check_tails_dorado_DRS}
\alias{check_tails_dorado_DRS}
\title{Wrapper function for complete DRS processing by ninetails package (Dorado mode).}
\usage{
check_tails_dorado_DRS(
  bam_file,
  dorado_summary,
  pod5_dir,
  num_cores = 1,
  qc = TRUE,
  save_dir,
  prefix = "",
  part_size = 1000
)
}
\arguments{
\item{bam_file}{Character string. Full path to the BAM file produced by Dorado
(>=1.0.0) containing poly(A) information in 'pt' and 'pa' tags.}

\item{dorado_summary}{Character string or data frame. Either the full path to
the Dorado summary file (.txt) or a data frame containing the summary
information with required columns (filename, read_id).}

\item{pod5_dir}{Character string. Full path to the directory containing POD5
files. These files must correspond to the reads in the BAM file.}

\item{num_cores}{Numeric [1]. Number of physical cores to use for processing.
Should not exceed one less than the total available cores. Defaults to 1.}

\item{qc}{Logical [TRUE/FALSE]. If TRUE, performs quality control on the
output data. This includes checking for read duplicates and validating
poly(A) coordinates. Enabled by default.}

\item{save_dir}{Character string. Full path to the directory where output
files and subdirectories will be created.}

\item{prefix}{Character string (optional). When provided, this string is
prepended to output filenames, positioned between the timestamp and the
file type suffix.}

\item{part_size}{Numeric [40000]. Defines the maximum number of reads to
process in each file part. Must be >=1000. Used to split large inputs
into manageable parts to prevent memory overflow.}
}
\value{
A list containing processed file paths and analysis results. Always
assign the returned list to a variable to prevent console overflow. The
function also generates a log file and output files in the specified
save_dir.
}
\description{
This function processes Oxford Nanopore direct RNA sequencing (DRS) data
generated using Dorado basecaller (>=1.0.0) and POD5 file format. It extracts
and analyzes poly(A) tail information from BAM files containing 'pt' and 'pa'
tags, which store poly(A) tail length and coordinates respectively.
}
\details{
The function performs several key steps:\itemize{
\item Validates and preprocesses input files
\item Splits large BAM and summary files into manageable parts
\item Extracts poly(A) information from BAM files
\item Performs quality control if enabled
\item Generates output files and logs
}

Output subdirectories:
\itemize{
  \item dorado_summary_dir - Split summary files
  \item bam_dir - Split BAM files
  \item polya_data_dir - Extracted poly(A) information
  \item polya_signal_dir - Extracted poly(A) signals
}
}
\examples{
\dontrun{
results <- check_tails_dorado_DRS(
  bam_file = "path/to/basecalled.bam",
  dorado_summary = "path/to/alignment_summary.txt",
  pod5_dir = "path/to/pod5/",
  num_cores = 2,
  qc = TRUE,
  save_dir = "path/to/output/",
  prefix = "experiment1",
  part_size = 40000
)
}
}
