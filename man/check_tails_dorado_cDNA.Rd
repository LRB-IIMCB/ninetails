% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/check_tails_dorado_cDNA.R
\name{check_tails_dorado_cDNA}
\alias{check_tails_dorado_cDNA}
\title{Complete Oxford Nanopore poly(A)/poly(T) tail analysis pipeline for Dorado cDNA data.}
\usage{
check_tails_dorado_cDNA(
  bam_file,
  dorado_summary,
  pod5_dir,
  num_cores = 1,
  qc = TRUE,
  save_dir,
  prefix = "",
  part_size = 40000,
  cleanup = FALSE
)
}
\arguments{
\item{bam_file}{Character string. Path to the BAM file containing aligned cDNA reads
with basecalled sequences. This file will be split into parts for memory management.}

\item{dorado_summary}{Character string or data frame. Path to Dorado summary file or
data frame containing per-read summary information. Must include standard columns
such as read_id, filename, etc.}

\item{pod5_dir}{Character string. Path to directory containing POD5 files with raw
nanopore signal data corresponding to the reads in the summary file.}

\item{num_cores}{Integer [1]. Number of CPU cores to use for parallel processing.
Recommend using `parallel::detectCores() - 1` for optimal performance while
maintaining system responsiveness.}

\item{qc}{Logical [TRUE]. Whether to apply quality control filtering during
analysis. When TRUE, applies standard ninetails QC filters including tail length
filtering and coordinate validation.}

\item{save_dir}{Character string. Path to directory where all output files and
intermediate results will be saved. Directory will be created if it doesn't exist.}

\item{prefix}{Character string [""]. Optional prefix to add to all output file names.
Useful for distinguishing between different experimental conditions or samples.}

\item{part_size}{Integer [40000]. Number of reads to process in each chunk when
splitting large input files. Larger values use more memory but may be faster.
Adjust based on available system memory.}

\item{cleanup}{Logical [FALSE]. Whether to remove intermediate files after successful
pipeline completion. When FALSE, all intermediate files are preserved for inspection.}
}
\value{
A named list containing the final analysis results:
\describe{
  \item{read_classes}{Data frame with per-read classification results including
    tail type (polyA/polyT), decoration status, and metadata}
  \item{nonadenosine_residues}{Data frame with predicted non-adenosine positions
    within tails, including tail type information}
  \item{processing_stats}{Summary statistics of the analysis including counts
    of polyA vs polyT reads processed}
}
}
\description{
This comprehensive wrapper function orchestrates the complete analysis of Oxford Nanopore
cDNA sequencing data processed with Dorado basecaller (>=1.0.0) using POD5 and BAM
file formats. The pipeline identifies and characterizes non-adenosine nucleotides within
poly(A) and poly(T) tails through advanced signal processing, sequence classification,
machine learning-based prediction, and statistical analysis.
}
\section{Pipeline Overview}{

The analysis pipeline consists of several integrated stages:
\enumerate{
  \item \strong{Input Validation}: Validates Dorado summary files, BAM files, and POD5 directories
  \item \strong{BAM Processing}: Splits large BAM files and extracts basecalled sequences
  \item \strong{Sequence Classification}: Classifies reads as polyA, polyT, or unidentified based on primer alignment
  \item \strong{Signal Extraction}: Extracts poly(A)/poly(T) tail signals from POD5 files
  \item \strong{Dual Processing}: Separately processes polyA and polyT reads with appropriate models
  \item \strong{Results Merging}: Combines results and adds tail type information
  \item \strong{Output Creation}: Produces comprehensive results with tail type classification
  \item \strong{Cleanup}: Optionally removes intermediate files to save disk space
}
}

\section{Input Requirements}{

This pipeline requires specific input formats:
\itemize{
  \item \strong{Dorado Summary}: Must contain standard columns for read information
  \item \strong{BAM File}: Aligned cDNA reads with basecalled sequences
  \item \strong{POD5 Files}: Raw signal files corresponding to reads in summary
}
}

\section{Key Differences from DRS Pipeline}{

\itemize{
  \item \strong{BAM Input}: Additional BAM file input for sequence extraction
  \item \strong{Orientation Classification}: Automatic polyA/polyT classification
  \item \strong{Dual Model Processing}: Separate processing paths for polyA and polyT
  \item \strong{Enhanced Output}: Results include tail type information
}
}

\examples{
\dontrun{
# Basic cDNA analysis
results <- ninetails::check_tails_dorado_cDNA(
  bam_file = "path/to/aligned_cdna.bam",
  dorado_summary = "path/to/dorado_summary.txt",
  pod5_dir = "path/to/pod5_files/",
  num_cores = 4,
  save_dir = "path/to/output/"
)

# Access results
head(results$read_classes)
head(results$nonadenosine_residues)

# Analysis with custom settings
results <- ninetails::check_tails_dorado_cDNA(
  bam_file = "large_dataset.bam",
  dorado_summary = summary_df,  # Can pass data frame
  pod5_dir = "/data/pod5/",
  num_cores = 8,
  qc = TRUE,
  save_dir = "/results/experiment1/",
  prefix = "exp1_sample_A",
  part_size = 20000,  # Smaller chunks for limited memory
  cleanup = TRUE      # Remove intermediate files
)
}
}
