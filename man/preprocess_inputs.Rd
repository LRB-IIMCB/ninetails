% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ninetails_core_functions_dorado_DRS.R
\name{preprocess_inputs}
\alias{preprocess_inputs}
\title{Preprocess Dorado inputs for ninetails analysis (no BAM processing)}
\usage{
preprocess_inputs(
  dorado_summary,
  pod5_dir,
  num_cores,
  qc,
  save_dir,
  prefix,
  part_size,
  cli_log
)
}
\arguments{
\item{dorado_summary}{Character or data frame. Path to Dorado summary file or data frame.}

\item{pod5_dir}{Character. Directory containing pod5 files.}

\item{num_cores}{Integer. Number of CPU cores to use.}

\item{qc}{Logical. Whether to perform quality control filtering. When \code{TRUE},
applies the following stringent filters to ensure high-quality data:
\describe{
  \item{Alignment direction}{Removes unmapped reads (\code{alignment_direction == "*"})}
  \item{Mapping quality}{Removes reads with zero mapping quality (\code{alignment_mapq == 0})}
  \item{Poly(A) coordinates}{Removes reads with invalid start positions (\code{poly_tail_start == 0})}
  \item{Tail length}{Removes reads with tails shorter than 10 nucleotides (\code{poly_tail_length < 10})}
}
These filters remove low-quality reads, misaligned sequences, and likely artifacts
from pore clogging or basecalling errors. Set to \code{FALSE} only for preliminary
analysis or when using pre-filtered data.}

\item{save_dir}{Character. Directory where output files will be saved.}

\item{prefix}{Character. Prefix to add to output file names (optional).}

\item{part_size}{Integer. Number of reads to process in each chunk.}

\item{cli_log}{Function for logging messages and progress.}
}
\value{
List containing paths to processed files:
  \describe{
    \item{summary_files}{Paths to split summary files}
    \item{polya_signal_files}{Paths to extracted poly(A) signal files}
  }
}
\description{
This function prepares Dorado summary files and extracts poly(A) signals
from POD5 files for downstream analysis. It splits large summary files into
manageable parts and extracts corresponding poly(A) signals.
}
\section{Quality Control Details}{

The quality control filtering (when \code{qc = TRUE}) is implemented via
\code{\link{filter_dorado_summary}} and performs the following operations:
\itemize{
  \item \strong{Unmapped read removal}: Reads with \code{alignment_direction = "*"}
    indicate failed alignment to the reference and are excluded.
  \item \strong{Low mapping quality removal}: Reads with \code{alignment_mapq = 0}
    have ambiguous or poor-quality alignments and are excluded.
  \item \strong{Invalid coordinate removal}: Reads with \code{poly_tail_start = 0}
    indicate failed poly(A) detection, often from pore clogging artifacts.
  \item \strong{Short tail removal}: Reads with \code{poly_tail_length < 10} nucleotides
    lack sufficient poly(A) sequence for reliable modification detection.
}

These criteria ensure that only high-confidence reads with valid poly(A) tails
and proper genomic alignment are processed, significantly improving downstream
classification accuracy and reducing false positive rates.
}

\section{Performance Note}{

Filtering typically removes 25-30\% of raw reads from standard Dorado output,
but this percentage may vary based on sequencing quality, pore condition, and
alignment parameters. The function logs the exact number of reads removed for
quality control tracking.
}

\examples{
\dontrun{
processed_files <- preprocess_inputs(
  dorado_summary = "path/to/summary.txt",
  pod5_dir = "path/to/pod5/",
  num_cores = 2,
  qc = TRUE,
  save_dir = "path/to/output/",
  prefix = "experiment1",
  part_size = 40000,
  cli_log = message
)
}
}
