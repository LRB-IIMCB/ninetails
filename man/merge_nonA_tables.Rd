% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ninetails_data_postprocessing_functions.R
\name{merge_nonA_tables}
\alias{merge_nonA_tables}
\title{Merges ninetails tabular outputs (read classes and nonadenosine residue
data) to produce one concise table.}
\usage{
merge_nonA_tables(class_data, residue_data, pass_only = TRUE)
}
\arguments{
\item{class_data}{Data frame or tibble containing read_classes
predictions produced by the ninetails pipeline.}

\item{residue_data}{Data frame or tibble containing non-A residue
predictions produced by the ninetails pipeline.}

\item{pass_only}{Logical \code{[TRUE]}. If \code{TRUE}, only reads
tagged by nanopolish as \code{"PASS"} are included. If \code{FALSE},
reads tagged as \code{"PASS"} or \code{"SUFFCLIP"} are included.
\strong{Must match the setting used during pipeline execution.}}
}
\value{
A tibble with summarised information from both ninetails
  outputs: all columns from \code{class_data} plus
  \code{prediction_C}, \code{prediction_G}, \code{prediction_U}, and
  \code{nonA_residues}.
}
\description{
Combines the \code{read_classes} and \code{nonadenosine_residues} data
frames into a single wide-format tibble with one row per read. The
\code{prediction} column from the residue data is spread into three
columns (\code{prediction_C}, \code{prediction_G}, \code{prediction_U})
via \code{\link{spread_nonA_residues}}, and a CIGAR-like
\code{nonA_residues} summary column is appended.
}
\details{
Unclassified reads are excluded before merging. The quality-tag filter
(\code{pass_only}) must match the setting used during pipeline
execution to ensure consistency. After the full join, any \code{NA}
values in numeric columns are replaced with 0.
}
\examples{
\dontrun{

merged_tables <- ninetails::merge_nonA_tables(
  class_data = class_data,
  residue_data = residue_data,
  pass_only = TRUE)

}
}
\seealso{
\code{\link{spread_nonA_residues}} for the reshaping step,
  \code{\link{summarize_nonA}} for transcript-level summaries from the
  merged table,
  \code{\link{calculate_fisher}} for statistical testing on the merged
  table,
  \code{\link{read_class_single}} and \code{\link{read_residue_single}}
  for loading the input data.
}
