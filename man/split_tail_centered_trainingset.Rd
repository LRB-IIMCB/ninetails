% Generated by roxygen2: do not edit by hand
% Please edit documentation in
%   R/ninetails_training_dataset_production_functions.R
\name{split_tail_centered_trainingset}
\alias{split_tail_centered_trainingset}
\title{Extracts decoration-centered fragments of poly(A) tail signal along
with positional coordinates.}
\usage{
split_tail_centered_trainingset(readname, tail_feature_list)
}
\arguments{
\item{readname}{Character string. Name (UUID) of the given read.}

\item{tail_feature_list}{List object produced by
\code{\link{create_tail_feature_list_trainingset}}.}
}
\value{
A named nested list where each element corresponds to one chunk
  and contains:
\describe{
  \item{chunk_sequence}{Numeric vector (length 100). The signal
    fragment centered on the potential modification.}
  \item{chunk_start_pos}{Integer. Start index of the chunk within the
    full tail signal (may be negative for left-padded chunks).}
  \item{chunk_end_pos}{Integer. End index of the chunk within the full
    tail signal.}
  \item{pseudomoves}{Numeric vector (length 100). Recomputed
    pseudomoves for the chunk. Coordinates are from the 3' end.}
}
}
\description{
Splits a single read's poly(A) tail signal into fixed-length (100
data-point) chunks, each centered on a potential non-A decoration
detected from the pseudomove vector. Chunks whose start position falls
before index 1 are left-padded with values randomly sampled from the
three most frequent signal values.
}
\details{
This training-set variant includes an additional \code{pseudomoves}
element in each chunk sublist, making the output suitable for
supervised training/validation data preparation. Pseudomoves for each
extracted chunk are recomputed by calling
\code{\link{filter_signal_by_threshold}} on the chunk sequence.

The centering procedure:
\enumerate{
  \item Runs RLE on the pseudomove vector.
  \item Selects runs of length >= 4 with non-zero values (empirical
        modification threshold).
  \item Centers a 100-element window on the midpoint of each selected
        run.
}

Chunk names follow the convention \code{<readname>_<index>}, where
\code{index} is the sequential position of the modification within
the read (numbered from the 3' end).
}
\examples{
\dontrun{

split_tail_centered_trainingset(
  readname = "1234-anexample-r3adn4m3",
  tail_feature_list = tail_feature_list)

}
}
\seealso{
\code{\link{create_tail_chunk_list_trainingset}} for the
  parallel wrapper that calls this function,
  \code{\link{filter_signal_by_threshold}} for pseudomove recomputation
  on individual chunks,
  \code{\link{split_tail_centered}} for the production counterpart.
}
