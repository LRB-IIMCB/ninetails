% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ninetails_data_postprocessing_functions.R
\name{correct_class_data}
\alias{correct_class_data}
\title{Corrects the classification of reads contained in the class_data table.}
\usage{
correct_class_data(residue_data_edited, class_data)
}
\arguments{
\item{residue_data_edited}{Data frame or tibble. Corrected non-A
residue predictions produced by \code{\link{correct_residue_data}}.
Must contain columns \code{mode_pos}, \code{seg_err_quart}, and
\code{qc_pos}.}

\item{class_data}{Data frame or tibble containing read_classes
predictions from the ninetails pipeline.}
}
\value{
A tibble identical to \code{class_data} with two additional
  columns:
\describe{
  \item{corr_class}{Character. Corrected classification: original
    \code{class} value, or \code{"blank"} for artefact-only reads.}
  \item{corr_comments}{Character. Corrected comment: original
    \code{comments} value, or \code{"MPU"} for reclassified reads.}
}
}
\description{
Introduces two additional columns (\code{corr_class} and
\code{corr_comments}) to the \code{class_data} table, reclassifying
reads based on the positional quality flags computed by
\code{\link{correct_residue_data}}. Reads whose \emph{all} non-A
positions were flagged as ambiguous (\code{qc_pos == "N"}) are
downgraded from \code{"decorated"} to \code{"blank"}.
}
\details{
The reclassification logic: for each read, if every non-A residue
position has \code{qc_pos == "N"}, the read is reclassified as
\code{"blank"} with comment \code{"MPU"} (to maintain compatibility
with the tag system used in plotting functions). Reads with at least
one \code{qc_pos == "Y"} position retain their original class and
comment.
}
\section{Caution}{

It is recommended to use \code{\link{reclassify_ninetails_data}}
for downstream analyses, as it wraps this function together with
\code{\link{correct_residue_data}} and performs the necessary column
renaming. If using this function directly, rename \code{corr_class}
and \code{corr_comments} to \code{class} and \code{comments} before
plotting.
}

\examples{
\dontrun{

class_data_corrected <- ninetails::correct_class_data(
  residue_data_edited = residue_data_edited,
  class_data = results[[1]])

}

}
\seealso{
\code{\link{correct_residue_data}} for the preceding step,
  \code{\link{reclassify_ninetails_data}} for the high-level wrapper,
  \code{\link{create_outputs}} for the pipeline that produces the
  input data.
}
