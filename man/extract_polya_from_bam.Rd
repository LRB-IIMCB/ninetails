% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ninetails_core_functions_dorado_DRS.R
\name{extract_polya_from_bam}
\alias{extract_polya_from_bam}
\title{Extract poly(A) information from BAM file}
\usage{
extract_polya_from_bam(bam_file, summary_file, cli_log = message)
}
\arguments{
\item{bam_file}{Character path to the BAM file containing aligned reads with poly(A) information.}

\item{summary_file}{Character path to the summary file containing read_id and filename mapping.}

\item{cli_log}{Function for logging messages, defaults to message.}
}
\value{
A data frame containing poly(A) information with columns:
  \describe{
    \item{read_id}{Unique read identifier}
    \item{filename}{Corresponding pod5 file name}
    \item{reference}{Reference sequence name}
    \item{ref_start}{Alignment start position}
    \item{ref_end}{Alignment end position}
    \item{mapq}{Mapping quality score}
    \item{poly_tail_length}{Length of poly(A) tail}
    \item{poly_tail_start}{Poly(A) start position}
    \item{poly_tail_end}{Poly(A) end position}
    \item{poly_tail2_start}{Secondary poly(A) start position}
    \item{poly_tail2_end}{Secondary poly(A) end position}
  }
}
\description{
Extracts poly(A) tail coordinates and related information from a BAM file using a summary file for pod5 file mapping.
}
\examples{
\dontrun{
polya_data <- extract_polya_from_bam(
  bam_file = "path/to/aligned.bam",
  summary_file = "path/to/summary.txt"
)
}
}
