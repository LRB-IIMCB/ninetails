% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_polya_from_bam.R
\name{extract_polya_from_bam}
\alias{extract_polya_from_bam}
\title{Extract poly(A) tail information from BAM file}
\usage{
extract_polya_from_bam(bam_file)
}
\arguments{
\item{bam_file}{character string. Full path to the BAM file containing Dorado
basecalling results. The BAM file must contain pt and pa tags for poly(A) tail
information.}
}
\value{
A nested list organized by read names, where each element corresponds to a read and contains:\itemize{
\item reference - Reference sequence name
\item ref_start - Start position on the reference
\item ref_end - End position on the reference
\item mapq - Mapping quality score
\item polya_length - Poly(A) tail length from pt tag
\item anchor_pos - Anchor position from pa tag
\item polya_start - Poly(A) start position from pa tag
\item polya_end - Poly(A) end position from pa tag
\item secondary_polya_start - Secondary poly(A) start position from pa tag
\item secondary_polya_end - Secondary poly(A) end position from pa tag
}
}
\description{
This function extracts poly(A) tail information from a BAM file produced by
Dorado basecaller. The function processes BAM files containing pt (poly(A) tail length)
and pa (poly(A) region coordinates) tags, filtering out unmapped and non-primary
alignments. Only reads containing valid pt tags are included in the output.
}
\details{
The BAM file must be produced with Dorado version 1.0.0 or higher
and contain pt and pa tags for poly(A) tail information. Files produced with earlier
versions of Dorado will not generate correct output due to differences in tags.

The function applies the following filtering criteria:\itemize{
\item Excludes reads without pt tag
\item Excludes unmapped reads
\item Excludes non-primary alignments
\item Removes duplicate read names (keeps first occurrence)
}

Progress and filtering statistics are reported during execution.
}
\examples{
\dontrun{
polya_data <- extract_polya_from_bam("/path/to/basecalled.bam")
}

}
