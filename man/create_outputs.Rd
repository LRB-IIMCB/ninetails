% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ninetails_core_functions.R
\name{create_outputs}
\alias{create_outputs}
\title{Create ninetails output tables (Guppy legacy pipeline)}
\usage{
create_outputs(
  tail_feature_list,
  tail_chunk_list,
  nanopolish,
  predicted_list,
  num_cores,
  pass_only = TRUE,
  qc = TRUE
)
}
\arguments{
\item{tail_feature_list}{List object produced by
\code{\link{create_tail_feature_list}}.}

\item{tail_chunk_list}{List object produced by
\code{\link{create_tail_chunk_list}}.}

\item{nanopolish}{Character string or data frame. Full path of the
\code{.tsv} file produced by nanopolish polya function, or an in-memory
data frame.}

\item{predicted_list}{List object produced by
\code{\link{predict_gaf_classes}}.}

\item{num_cores}{Numeric. Number of physical cores to use in processing.
Do not exceed 1 less than the number of cores at your disposal.}

\item{pass_only}{Logical. If \code{TRUE} (default), only reads tagged by
nanopolish as \code{"PASS"} are taken into consideration. If \code{FALSE},
reads tagged as \code{"PASS"} and \code{"SUFFCLIP"} are both included.}

\item{qc}{Logical. If \code{TRUE} (default), quality control of the output
predictions is performed. Reads with non-A residue positions in terminal
nucleotides (< 2 nt from either end of the tail) are labeled with
\code{"-WARN"} suffixes, as these are most likely artifacts inherited
from nanopolish segmentation. It is then up to the user whether to
include or discard such reads from downstream analysis.}
}
\value{
A named list with two data frames:
  \describe{
    \item{read_classes}{Data frame with per-read classification results.
      Columns: \code{readname}, \code{contig}, \code{polya_length},
      \code{qc_tag}, \code{class}, and \code{comments}.}
    \item{nonadenosine_residues}{Data frame with per-chunk predictions of
      non-adenosine residues for decorated reads only. Columns:
      \code{readname}, \code{contig}, \code{prediction}, \code{est_nonA_pos},
      \code{polya_length}, \code{qc_tag}. When \code{qc = TRUE}, prediction
      values may carry a \code{"-WARN"} suffix for terminal positions.}
  }
}
\description{
Integrates nanopolish poly(A) tail data, CNN predictions, and positional
information to generate two main outputs: per-read classifications and
non-adenosine residue predictions with estimated positions along the
poly(A) tail.
}
\details{
The function implements a complete read accounting system that classifies
all reads from the nanopolish output into biologically meaningful categories
based on both quality control metrics and modification detection results.
}
\section{Read Classification System}{

  Reads are assigned into three main categories with specific comment codes:

  \strong{decorated} - Reads with detected non-adenosine modifications
  \itemize{
    \item YAY: Move transition present, nonA residue detected
  }

  \strong{blank} - Reads without detected modifications
  \itemize{
    \item MAU: Move transition absent, nonA residue undetected
    \item MPU: Move transition present, nonA residue undetected
  }

  \strong{unclassified} - Reads that failed quality control
  \itemize{
    \item IRL: Insufficient read length (poly(A) < 10 nt)
    \item QCF: Nanopolish QC failed
    \item NIN: Not included in the analysis (\code{pass_only = TRUE})
  }
}

\section{Position Estimation}{

  Non-adenosine residue positions are estimated using the formula:

  \code{est_nonA_pos = polya_length - ((polya_length * centr_signal_pos) /
  signal_length)}

  Positions are reported as distance from the 3' end of the tail
  (position 1 = most 3' nucleotide).
}

\examples{
\dontrun{

create_outputs(
  tail_feature_list = tail_feature_list,
  tail_chunk_list = tail_chunk_list,
  nanopolish = '/path/to/nanopolish_output.tsv',
  predicted_list = predicted_list,
  num_cores = 2,
  pass_only = TRUE,
  qc = TRUE
)

}


}
\seealso{
\code{\link{create_tail_feature_list}} for feature extraction,
\code{\link{create_tail_chunk_list}} for chunk segmentation,
\code{\link{predict_gaf_classes}} for CNN classification,
\code{\link{check_tails_guppy}} for the complete pipeline wrapper
}
