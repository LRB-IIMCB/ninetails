% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_tails_from_pod5.R
\name{extract_tails_from_pod5}
\alias{extract_tails_from_pod5}
\title{Extract poly(A) tail signal segments from POD5 files}
\usage{
extract_tails_from_pod5(polya_data, pod5_dir)
}
\arguments{
\item{polya_data}{A data frame with at least the following columns:
\describe{
 \item{read_id}{Character: ONT read identifiers.}
 \item{pod5_file}{Character: corresponding POD5 filename (relative to `pod5_dir`).}
 \item{polya_start}{Integer/numeric: start index of the poly(A) region in the signal.}
 \item{polya_end}{Integer/numeric: end index of the poly(A) region in the signal.}
}}

\item{pod5_dir}{Character string. Path to the directory containing POD5 files referenced in
`polya_data$pod5_file`. Equivalent to guppy workspace.}
}
\value{
A tibble combining the original rows from `polya_data` with:
\describe{
 \item{polya_signal}{list-column: each element is an atomic numeric vector
 with the extracted signal (length may be zero if extraction failed or read missing).}
 \item{signal_length}{integer: length of the extracted `polya_signal`.}
}
}
\description{
The function uses \pkg{reticulate} to import the Python library `pod5`. For each pod5 file referenced in
`polya_data` it opens a `pod5.Reader`, enumerates reads, matches `read_id` and extracts the numeric
slice `signal[polya_start:polya_end]` whenever indices are valid. If a read is missing or indices are
invalid, `polya_signal` for that row will be `numeric(0)` and `signal_length = 0`.
}
\details{
The function performs several input checks and will stop early with informative messages when
required arguments or columns are missing or have incorrect types.
}
\examples{
\dontrun{
res <- extract_tails_from_pod5(polya_data, "/path/to/pod5_dir")
}


}
