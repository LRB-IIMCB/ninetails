% Generated by roxygen2: do not edit by hand
% Please edit documentation in
%   R/ninetails_training_dataset_production_functions.R
\name{create_tail_feature_list_A}
\alias{create_tail_feature_list_A}
\title{Extracts features of poly(A) tails containing only A nucleotides for
training-set preparation.}
\usage{
create_tail_feature_list_A(
  nanopolish,
  sequencing_summary,
  workspace,
  num_cores,
  basecall_group,
  pass_only = TRUE
)
}
\arguments{
\item{nanopolish}{Character string. Full path of the \code{.tsv} file
produced by \code{nanopolish polya}.}

\item{sequencing_summary}{Character string. Full path of the \code{.txt}
file with the sequencing summary.}

\item{workspace}{Character string. Full path of the directory containing
basecalled multi-Fast5 files.}

\item{num_cores}{Numeric \code{[1]}. Number of physical cores to use.
Do not exceed 1 less than the number of cores at your disposal.}

\item{basecall_group}{Character string \code{["Basecall_1D_000"]}. Name of
the level in the Fast5 file hierarchy from which the data should be
extracted.}

\item{pass_only}{Logical \code{[TRUE]}. If \code{TRUE}, only reads tagged
by nanopolish as \code{"PASS"} are retained. Otherwise, reads tagged as
\code{"PASS"} or \code{"SUFFCLIP"} are included.}
}
\value{
A named list with one element:
\describe{
  \item{tail_feature_list}{Named list of per-read feature lists (as
    returned by \code{\link{extract_tail_data_trainingset}}) containing
    only reads with pure A tails.}
}
Always assign this returned list to a variable; printing the full list
to the console may crash the R session.
}
\description{
Training-set variant of the feature extraction wrapper designed
exclusively for A-only signals. It processes all reads in parallel via
\code{\link{extract_tail_data_trainingset}}, then applies an inverse
filtering criterion: only reads whose pseudomove vectors do \emph{not}
contain consecutive non-zero runs of length >= 4 are retained. This
ensures the resulting dataset represents pure homopolymer A tails
without modification artefacts.
}
\details{
The inverse filtering uses a sliding-window approach
(\code{stats::embed}) to detect runs of >= 4 consecutive non-zero
pseudomoves. Reads that pass this filter (i.e. have no such runs)
are collected as the A-only reference set. Unlike
\code{\link{create_tail_feature_list_trainingset}}, the returned list
does not include \code{zeromoved_readnames} or
\code{nonpseudomoved_readnames} categories.
}
\examples{
\dontrun{

create_tail_feature_list_A(
  nanopolish = '/path/to/file',
  sequencing_summary = '/path/to/file',
  workspace = '/path/to/guppy/workspace',
  num_cores = 10,
  basecall_group = 'Basecall_1D_000')

}
}
\seealso{
\code{\link{create_tail_feature_list_trainingset}} for the
  non-A variant,
  \code{\link{create_tail_chunk_list_A}} for the next pipeline step,
  \code{\link{extract_tail_data_trainingset}} for per-read extraction,
  \code{\link{prepare_trainingset}} for the top-level wrapper.
}
