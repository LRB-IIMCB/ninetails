% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ninetails_misc_helper_functions.R
\name{filter_dorado_summary}
\alias{filter_dorado_summary}
\title{Filter Dorado summary for reads fulfilling ninetails quality criteria}
\usage{
filter_dorado_summary(dorado_summary)
}
\arguments{
\item{dorado_summary}{Character string or data frame. Path to a
tab-delimited Dorado summary file, or a data frame containing
equivalent summary information. Must contain at least the columns
\code{read_id} and \code{poly_tail_length}.}
}
\value{
A filtered tibble or data frame containing only reads that meet
  the filtering criteria.
}
\description{
Takes a Dorado summary file (from ONT Dorado basecaller) or a data frame
containing equivalent summary information, and filters out reads that do
not meet ninetails quality and alignment criteria.
}
\details{
Reads must meet all four criteria to pass the filter:
\enumerate{
  \item \strong{Mapped}: \code{alignment_direction} is \code{"+"} or
    \code{"-"}, not \code{"*"}
  \item \strong{High mapping quality}: \code{alignment_mapq} > 0
  \item \strong{Valid coordinates}: \code{poly_tail_start} != 0 (in DRS,
    the adapter passes through the pore first, so a start position of 0
    indicates a likely artifact)
  \item \strong{Sufficient length}: \code{poly_tail_length} >= 10 nt
    (shorter tails cannot be reliably processed by the CNN)
}
}
\examples{
\dontrun{

# From file
filtered <- filter_dorado_summary("dorado_summary.txt")

# From data frame
df <- data.frame(
  read_id = c("read1", "read2"),
  alignment_direction = c("+", "*"),
  alignment_mapq = c(60, 0),
  poly_tail_start = c(100, 0),
  poly_tail_length = c(20, 5)
)
filtered <- filter_dorado_summary(df)

}
}
\seealso{
\code{\link{preprocess_inputs}} and \code{\link{preprocess_inputs_cdna}}
where this function is called during pipeline initialization,
\code{\link{process_dorado_summary}} for splitting large summary files
}
