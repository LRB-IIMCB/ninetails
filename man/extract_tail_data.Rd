% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ninetails_core_functions.R
\name{extract_tail_data}
\alias{extract_tail_data}
\title{Extract tail features of a single RNA read from a multi-Fast5 file}
\usage{
extract_tail_data(readname, polya_summary, workspace, basecall_group)
}
\arguments{
\item{readname}{Character string. Name of the given read (UUID) within
the analyzed dataset.}

\item{polya_summary}{Data frame. The table containing data extracted from
nanopolish and sequencing summary, as produced by
\code{\link{extract_polya_data}}.}

\item{workspace}{Character string. Full path of the directory containing
the basecalled multi-Fast5 files.}

\item{basecall_group}{Character string. Name of the level in the Fast5
file hierarchy from which data should be extracted (e.g.,
\code{"Basecall_1D_000"}).}
}
\value{
A named list containing per-read tail features:
  \describe{
    \item{fast5_filename}{Character. Name of the source Fast5 file}
    \item{tail_signal}{Numeric vector. Winsorized and downsampled poly(A)
      tail signal}
    \item{tail_moves}{Numeric vector. Downsampled basecaller moves for
      the tail region}
    \item{tail_pseudomoves}{Numeric vector. Pseudomove states computed
      from the tail signal (\{-1, 0, 1\})}
  }
  Always assign the returned list to a variable. Printing the full output
  to the console may crash your R session.
}
\description{
Extracts metadata and signal features of a single RNA read from a
multi-Fast5 file basecalled by Guppy. The tail signal, as delimited by
nanopolish polya function, is extracted, winsorized (to remove signal
cliffs), and downsampled to 20\% of its original length to facilitate
further analysis. Pseudomoves are computed from the processed signal
using \code{\link{filter_signal_by_threshold}}.
}
\details{
The function performs the following operations:
\enumerate{
  \item Reads raw signal from the multi-Fast5 file via \pkg{rhdf5}
  \item Retrieves basecaller moves and stride information
  \item Extracts the poly(A) tail region of the signal based on nanopolish
        coordinates
  \item Applies winsorization to the tail signal
        (\code{\link{winsorize_signal}})
  \item Downsamples both signal and moves to 20\% of original length via
        linear interpolation
  \item Computes pseudomoves using
        \code{\link{filter_signal_by_threshold}}
}
}
\examples{
\dontrun{

ninetails::extract_tail_data(
  readname = 'abc123de-fg45-6789-0987-6543hijk2109',
  polya_summary = polya_summary_table,
  workspace = '/path/to/folder/containing/multifast5s',
  basecall_group = 'Basecall_1D_000'
)

}
}
\seealso{
\code{\link{extract_polya_data}} for preparing the \code{polya_summary}
input, \code{\link{create_tail_feature_list}} for batch extraction,
\code{\link{filter_signal_by_threshold}} for pseudomove computation
}
